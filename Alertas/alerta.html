<!DOCTYPE HTML>
<html>
<head>
<title> Alertas </title>

</head>
<body>

<script language="javascript">

function loadJSON(callback) {   
    var xobj = new XMLHttpRequest();
    xobj.overrideMimeType("application/json");
    xobj.open('GET', 'https://raw.githubusercontent.com/oslugr/contaminAND/master/datos/contaminAND-gr-mar17-03.json', true); // Replace 'my_data' with the path to your file
    xobj.onreadystatechange = function () {
          if (xobj.readyState == 4 && xobj.status == "200") {
            // Required use of an anonymous callback as .open will NOT return a value but simply returns undefined in asynchronous mode
            callback(xobj.responseText);
          }
    };
    xobj.send(); 

}
function loadData() {

    loadJSON(function(response) {
      // Parse JSON string into object
        var actual_JSON = JSON.parse(response);
        console.log(actual_JSON[0].CO);
        if (actual_JSON[0].CO>200){
            notificacion("Alerta de mierda","no respires")
        }   
     });
    
    
    
}
function obtener_localizacion() {
  navigator.geolocation.getCurrentPosition(coordenadas);
}
function coordenadas(position) {
  var latitud = position.coords.latitude;
  var longitud = position.coords.longitude;
  alert('Tus coordenadas son: ('+latitud+','+longitud+')');
}


//source: https://developer.mozilla.org/en-US/docs/Web/API/notification

 

    function spawnNotification(theBody,theIcon,theTitle) {
      var options = {
          body: theBody,
          icon: theIcon
      }
      var n = new Notification(theTitle,options);
      setTimeout(n.close.bind(n), 5000); 
    }

    
    

function sleep(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

async function demo() {
  console.log('Taking a break...');
  await sleep(10000);
  console.log('10 second later');
  spawnNotification("mierda", undefined, "longaniza");
}

Notification.requestPermission();
spawnNotification("Esto es el cuerpo", undefined, "Título");
demo();
//loadData()
</script>
<a href="javascript:obtener_localizacion();">Mostrar Posición</a>
</body>
</html>
